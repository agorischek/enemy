var app=new Vue({el:"#app",data:{default:{registers:[1,1,1,1,1,1,1,1,1],pointerA:1,pointerB:2,status:"stop",output:[">"," "],currentCommandIndex:-1},delay:settings.delay,max:settings.max,min:settings.min,defaultProgram:settings.defaultProgram,registers:null,commands:commands,commandMap:commandMap,programs:programs,pointerA:null,pointerB:null,currentCommandIndex:null,output:null,settings:settings,status:null,inputValue:null,edit:"",readableCode:!1},watch:{status:function(){"go"==app.status||"step"==app.status?this.nextStep():"input"==app.status&&setTimeout(function(){$("#input").focus()},50)},program:function(){this.reset()}},methods:{insertProgram:function(t){app.edit=t},processBuiltInProgram:function(t){var n=t.slice(),s=this.shorthandToProper;return n.forEach(function(t,e){n[e]=s[t]}),n=n.join("")},step:function(){app.status="step"},reset:function(){this.status=this.default.status,this.currentCommandIndex=this.default.currentCommandIndex;var t=this.default.registers.slice();this.registers=t,this.pointerA=this.default.pointerA,this.pointerB=this.default.pointerB;var n=this.default.output.slice();this.output=n},withinRange:function(t){return!(t>=this.max)&&!(t<=this.min)},updateRegister:function(t,n){this.registers.splice(t,1,n)},runProgram:function(){"done"==this.status&&this.reset(),this.program?this.status="go":this.status="done"},pauseProgram:function(){this.status="pause"},getInput:function(){this.status="input",$("#input-box").focus()},submitInput:function(){var t=this.pointerA-1,n=Number(this.inputValue);NaN!=n&&(n>this.max?n=this.max:n<this.min&&(n=this.min),this.inputValue="",this.updateRegister(t,n),this.status="go")},nextStep:function(){switch(this.currentCommand){case"LL":this.commands.LL();break;case"LR":this.commands.LR();break;case"RL":this.commands.RL();break;case"RR":this.commands.RR();break;case"OP":this.commands.OP();break;case"CL":this.commands.CL();break;case"GV":this.commands.GV();break;case"TK":this.commands.TK();break}this.currentCommandIndex++,"input"!=this.status&&"step"!=this.status&&(this.status="delay",setTimeout(this.proceed,this.delay)),"step"==this.status&&(this.status="pause")},proceed:function(){this.currentCommandIndex>=this.programLength?this.status="done":"delay"==this.status&&(this.status="go")},showUnderline:function(t){return-1!=this.pointerRange.indexOf(t)}},computed:{displayStatus:function(){return"go"==this.status||"delay"==this.status?"Running":"done"==this.status?"Done":"pause"==this.status||"step"==this.status?"Paused":"stop"==this.status?"Ready":"input"==this.status?"Waiting for input...":this.status},parseEditAs:function(){var t=this.edit.charAt(0).toLowerCase(),n="";return"–"==t||"—"==t?n="proper":"n"==t||"m"==t?n="legible":"l"!=t&&"r"!=t&&"o"!=t&&"c"!=t&&"g"!=t&&"t"!=t||(n="shorthand"),n},program:function(){return this.editParsed?this.editParsed.slice():null},editParsed:function(){var t=this.edit,n=null,s=null;return"proper"==this.parseEditAs?(t=t.match(/[–—]+/g).join(""),t=t.match(/.{3}/g),n=this.properToShorthand,t&&t.forEach(function(s,e){t[e]=n[s]})):"shorthand"==this.parseEditAs?(t=t.match(/[LROPCLGVTK]+/g).join(""),t=t.match(/.{2}/g)):"legible"==this.parseEditAs&&(t=t.match(/[nm]+/g).join(""),t=this.edit.match(/.{3}/g),n=this.legibleToShorthand,t&&t.forEach(function(s,e){t[e]=n[s]})),t},outputFormatted:function(){return this.output?this.output.join(""):null},openCloseMatches:function(){var t=this.program.slice(),n=[];return t.forEach(function(s,e){if("OP"==s){var i=e,r=0,o=!1;t.forEach(function(t,s){if(0==o&&s>i)if("CL"==t&&0==r){var e=s;n.push([i,e]),o=!0}else"CL"==t?r-=1:"OP"==t&&(r+=1)})}}),n},openCommands:function(){var t=this.program.slice(),n=[];return t.forEach(function(t,s){"OP"==t&&n.push(s)}),n},openCount:function(){return this.openCommands.length},closeCommands:function(){var t=this.program.slice(),n=[];return t.forEach(function(t,s){"CL"==t&&n.push(s)}),n},closeCount:function(){return this.closeCommands.length},openCloseMatch:function(){return this.openCount==this.closeCount},openCloseCount:function(){return this.openCount>this.closeCount?this.openCount:this.closeCount},openClosePairs:function(){var t={},n={},s=this.openCloseMatches.slice(),e=this.openCount;return s.forEach(function(e,i){t[s[i][0]]=s[i][1],n[s[i][1]]=s[i][0]}),{open:t,close:n}},pointersAreEqual:function(){return this.pointerA==this.pointerB},pointerAValue:function(){return this.registers[this.pointerA-1]},pointerBValue:function(){return this.registers[this.pointerB-1]},registryLength:function(){return this.registers.slice().length},programLength:function(){return this.program.slice().length},currentCommand:function(){return this.program[this.currentCommandIndex]},pointerRange:function(){for(var t=[],n=this.pointerA,s=this.pointerB;n<=s;)t.push(n++);return t},verbose:function(){var t=this.program.slice(),n=this.shorthandToVerbose;return t.forEach(function(s,e){t[e]=n[s]}),t},shorthandOutput:function(){return this.shorthand.slice().join(" ")},shorthand:function(){return this.program.slice()},shorthandOutput:function(){return this.shorthand.slice().join("")},legible:function(){var t=this.program.slice(),n=this.shorthandToLegible;return t.forEach(function(s,e){t[e]=n[s]}),t},legibleOutput:function(){return this.legible.slice().join("")},proper:function(){var t=this.program.slice(),n=this.shorthandToProper;return t.forEach(function(s,e){t[e]=n[s]}),t},properOutput:function(){return this.proper.slice().join("")},shorthandToLegible:function(){var t={};return $.each(commandMap,function(n,s){var e=commandMap[n].shorthand,i=commandMap[n].legible;t[e]=i}),t},shorthandToProper:function(){var t={};return $.each(commandMap,function(n,s){var e=commandMap[n].shorthand,i=commandMap[n].proper;t[e]=i}),t},shorthandToVerbose:function(){var t={};return $.each(commandMap,function(n,s){var e=commandMap[n].shorthand,i=commandMap[n].verbose;t[e]=i}),t},properToShorthand:function(){var t={};return $.each(commandMap,function(n,s){var e=commandMap[n].proper,i=commandMap[n].shorthand;t[e]=i}),t},legibleToShorthand:function(){var t={};return $.each(commandMap,function(n,s){var e=commandMap[n].legible,i=commandMap[n].shorthand;t[e]=i}),t}}});